<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>خریدهای ماه | Monthly Expenses</title>
    <style>
        /* تم رنگی جدید */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #240356, #0d4654, #2f073f);
            color: white;
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }
        .container {
            width: 100%;
            max-width: 800px;
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);

        }
        h1 {
            text-align: center;
            color: #fffacd; /* رنگ متفاوت برای عنوان */
        }
        .login-section, .search-section, .input-section, .export-section, .contacts-section {
            margin-bottom: 20px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            border: 1px solid #00ced1;
            
        }
        .login-section input, .search-section input, .input-section input {
            padding: 10px;
            border: none;
            border-radius: 5px;
            width: calc(100% - 120px);
            #background: rgba(255, 255, 255, 0.2);
            color: blue;
            margin-bottom: 10px;
            width: 95%;

        }
        .login-section button, .search-section button, .input-section button, .export-section button, .contacts-section button {
            padding: 10px;
            border: none;
            border-radius: 5px;
            background: #9cfdff; /* رنگ متفاوت برای دکمه‌ها */
            color: rgb(38, 38, 6);
            cursor: pointer;
            margin-left: 10px;
            font-weight: bold;
        }
        .contacts-table {
            width: 100%;
            border-collapse: collapse;
        }
        .contacts-table th, .contacts-table td {
            padding: 10px;
            border-bottom: 1px solid #00ced1; /* رنگ متفاوت برای خطوط */
            text-align: right;
        }
        .contacts-table th {
            background: rgba(0, 206, 209, 0.2); /* رنگ متفاوت برای هدر جدول */
            cursor: pointer; /* نشانگر دست برای مرتب‌سازی */
        }
        .contacts-table td button {
            background: none;
            border: none;
            color: #fffacd; /* رنگ متفاوت برای آیکون‌ها */
            cursor: pointer;
        }
        .pagination {
            display: flex;
            justify-content: center;
            margin-top: 20px;
        }
        .pagination button {
            margin: 0 5px;
            background: #21354a; /* رنگ متفاوت برای دکمه‌های صفحه‌بندی */
            color:yellowgreen;
        }
        .page-info {
            text-align: center;
            margin-top: 10px;
            color: #fffacd; /* رنگ متفاوت برای اطلاعات صفحه */
        }
        .language-section {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 20px;
        }
        .language-section button {
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            background: #21354a; /* رنگ متفاوت برای دکمه‌های صفحه‌بندی */
            color:yellowgreen;
            cursor: pointer;
            font-size: 14px;
            font-weight: bold;
        }
        @media (max-width: 600px) {
            .login-section input, .search-section input, .input-section input {
                width: 95%;
                margin-bottom: 10px;
            }
            .login-section button, .search-section button, .input-section button, .export-section button, .contacts-section button {
                width: 100%;
                margin: 5px 0;
            }
            .search-section {
                display: flex;
                flex-direction: column;
                align-items: center;
            }
            .search-section input {
                width: 100%;
            }
            .search-section button {
                width: 100%;
                margin: 5px 0;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 id="appTitle">
            <span id="titleText" class="example">
                <style>
                    .example {
                      padding: 100 10 100 100px;
                      line-height: 50px;

        vertical-align: top;  white-space: normal;
                    }
                  </style>
                خرید ماهیانه </span>
            <svg width="40pt" height="40pt" viewBox="0 0 512 512" id="Layer_1" version="1.1" xml:space="preserve">
                <style type="text/css">
                    .st0{fill:#cbd444;}
                    .st1{fill:#f3b89c;}
                </style>
      
                <path class="st0" d="M476.8,258.4c-3.2-4.3-8-6.7-13.3-6.7c-0.1,0-0.1,0-0.2,0L256,253.6l-9.7-33.9c-0.9-3-3.6-5.1-6.8-5.1   l-24.4,0.2l0.1-0.2l-98.8-57.4c-4.2-2.4-8.7-3.5-13.1-3.5c-10.6,0-20.7,6.4-24.7,17.2c-1.1,2.9-1.6,5.9-1.6,8.8   c-0.1,12.3,8.6,23.7,21.5,26.1l42.5,9l68.3,14.4l0.3-0.8c0.8,0.3,1.7,0.5,2.7,0.5l22-0.2l9.7,33.9c0,0,0,0,0,0l27.5,96.4   c-4.2,1.4-8.1,3.8-11.3,7.1c-5.3,5.5-8.2,12.7-8.2,20.3c0.1,15.7,12.9,28.3,28.6,28.3c0.1,0,0.2,0,0.3,0l8-0.1   c-0.1,0.9-0.1,1.7-0.1,2.6c0.1,7.2,2.9,13.9,8,18.9c5,5,11.7,7.7,18.8,7.7c0.1,0,0.2,0,0.3,0c14.8-0.1,26.7-12.3,26.5-27   c0-0.9-0.1-1.7-0.2-2.6l42.5-0.4c-0.1,0.9-0.1,1.7-0.1,2.6c0.1,7.2,2.9,13.9,8,18.9c5,5,11.7,7.7,18.8,7.7c0.1,0,0.2,0,0.3,0   c14.8-0.1,26.7-12.3,26.5-27c0-0.9-0.1-1.7-0.2-2.6l23.1-0.2c3.9,0,7-3.2,6.9-7.1c0-3.9-3.2-7-7.1-6.9l-128.2,1.2c0,0,0,0,0,0   l-34.6,0.3c0,0,0,0,0,0l-17.3,0.2c-8.1,0.1-14.6-6.4-14.7-14.4c0-3.9,1.4-7.6,4.2-10.3c2.7-2.8,6.4-4.3,10.3-4.4l165.7-1.5   c0,0,0,0,0,0l14.4-0.1c3.9,0,7-3.2,6.9-7.1c0-3.8-3.2-6.9-7-6.9c0,0,0,0-0.1,0l-5,0l24-82.7C480.9,268,480,262.7,476.8,258.4z    M450.9,284.9l-16.3,56.1c-0.9,3.1-3.7,5.1-6.7,5.1c-0.6,0-1.3-0.1-2-0.3c-3.7-1.1-5.9-5-4.8-8.7l16.3-56.1c1.1-3.7,5-5.9,8.7-4.8   C449.8,277.3,451.9,281.1,450.9,284.9z"/>
                <circle class="st1" cx="134.6" cy="108.7" r="40.3"/>
                <polygon class="st1" points="31.9,436.7 46.7,436.7 85.2,340.2 50.9,322.8  "/>
                <path class="st0" d="M119.9,283l17-54.8l-41.1-8.7c-9.5-1.8-17.8-6.8-23.6-13.9l-9.2,50l-9.7,52.8l37.1,18.8l49.3,24.9l18.2,84.6   h17l-7.8-97.4L119.9,283z"/>
          
                </svg>

        </h1>

        <!-- بخش تغییر زبان -->
        <div class="language-section">
            <button onclick="changeLanguage('fa')">فارسی</button>
            <button onclick="changeLanguage('en')">English</button>
            <button onclick="changeLanguage('zh')">中文</button>
        </div>

        <!-- بخش لاگین -->
        <div class="login-section" id="loginSection">
            <h2 id="loginTitle">ورود به سیستم</h2>
            <input type="password" id="passwordInput" placeholder="رمز - Password">
            <button onclick="login()" id="loginButton">


                <svg height="30pt" width="30pt" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" 
                viewBox="0 0 512 512" xml:space="preserve">
           <path style="fill:#687F82;" d="M282.524,7.887C205.947,8.327,144.559,71.61,144.559,148.188v36.322h42.053v-36.615
               c0-53.25,42.52-97.436,95.768-97.952c53.769-0.52,97.677,43.068,97.677,96.719v75.193c0,11.402,8.866,21.112,20.26,21.517
               c11.962,0.425,21.793-9.146,21.793-21.013v-75.696C422.111,69.87,359.417,7.446,282.524,7.887z"/>
           <path style="fill:#4ACFD9;" d="M464.164,504.115H102.505V253.897c0-17.419,14.12-31.54,31.54-31.54h298.579
               c17.419,0,31.54,14.122,31.54,31.54V504.115z"/>
           <g>
               <path style="fill:#FFD1A9;" d="M359.031,432.624c0-41.805-33.891-75.696-75.696-75.696s-75.696,33.891-75.696,75.696v42.053
                   h151.392V432.624z"/>
               <circle style="fill:#FFD1A9;" cx="283.335" cy="298.053" r="46.259"/>
           </g>
           <path style="fill:#0295AA;" d="M134.045,222.357c-17.42,0-31.54,14.12-31.54,31.54v250.218h180.83V222.357H134.045z"/>
           <g>
               <path style="fill:#FF8C29;" d="M207.639,432.624v42.053h75.696v-117.75C241.528,356.928,207.639,390.819,207.639,432.624z"/>
               <path style="fill:#FF8C29;" d="M237.076,298.053c0,25.548,20.71,46.259,46.259,46.259v-92.517
                   C257.786,251.795,237.076,272.505,237.076,298.053z"/>
           </g>
           <g>
               <path style="fill:#FFFFFF;" d="M422.111,390.045c-4.355,0-7.885-3.53-7.885-7.885V277.027c0-4.355,3.53-7.885,7.885-7.885
                   c4.355,0,7.885,3.53,7.885,7.885V382.16C429.996,386.515,426.466,390.045,422.111,390.045z"/>
               <path style="fill:#FFFFFF;" d="M422.111,461.536c-4.355,0-7.885-3.53-7.885-7.885v-42.053c0-4.355,3.53-7.885,7.885-7.885
                   c4.355,0,7.885,3.53,7.885,7.885v42.053C429.996,458.006,426.466,461.536,422.111,461.536z"/>
           </g>
           <g>
               <path style="fill:#F0353D;" d="M80.546,191.075h-32.71c-4.355,0-7.885-3.53-7.885-7.885s3.53-7.885,7.885-7.885h32.71
                   c4.355,0,7.885,3.53,7.885,7.885S84.901,191.075,80.546,191.075z"/>
               <path style="fill:#F0353D;" d="M89.678,164.312c-2.018,0-4.036-0.77-5.575-2.31l-20.815-20.815c-3.079-3.079-3.079-8.072,0-11.152
                   s8.072-3.079,11.15,0l20.815,20.815c3.079,3.079,3.079,8.072,0,11.152C93.714,163.542,91.695,164.312,89.678,164.312z"/>
               <path style="fill:#F0353D;" d="M68.651,238.653c-2.018,0-4.036-0.77-5.575-2.31c-3.079-3.079-3.079-8.072,0-11.15l20.815-20.815
                   c3.079-3.079,8.072-3.079,11.15,0c3.079,3.079,3.079,8.072,0,11.15l-20.815,20.815C72.687,237.883,70.669,238.653,68.651,238.653z"
                   />
           </g>
           <path d="M432.624,214.472h-2.628v-67.811c0-39.275-15.378-76.194-43.302-103.959C358.977,15.144,322.305,0,283.343,0
               c-0.287,0-0.576,0.001-0.864,0.002C202.081,0.464,136.674,66.94,136.674,148.188v36.322c0,4.355,3.53,7.885,7.885,7.885h42.053
               c4.355,0,7.885-3.53,7.885-7.885v-36.615c0-49.193,39.459-89.597,87.96-90.067c23.882-0.187,46.361,8.91,63.356,25.741
               c16.998,16.835,26.36,39.241,26.36,63.093v67.811H134.045c-21.74,0-39.425,17.686-39.425,39.425v250.218
               c0,4.355,3.53,7.885,7.885,7.885h361.659c4.355,0,7.885-3.53,7.885-7.885V253.897C472.049,232.158,454.364,214.472,432.624,214.472z
                M356.909,72.363c-20.009-19.816-46.504-30.609-74.605-30.305c-57.113,0.554-103.577,48.031-103.577,105.836v28.73h-26.283v-28.437
               c0-72.602,58.374-132.003,130.126-132.416c0.259-0.001,0.512-0.002,0.771-0.002c34.765,0,67.497,13.519,92.235,38.115
               c24.924,24.782,38.651,57.731,38.651,92.776v67.811h-26.283v-67.811C387.943,118.568,376.921,92.182,356.909,72.363z
                M456.279,496.23H110.39V253.897c0-13.044,10.611-23.655,23.655-23.655h246.037h42.029h10.513c13.044,0,23.655,10.611,23.655,23.655
               V496.23z"/>
           <path d="M297.578,350.283c22.964-6.271,39.9-27.304,39.9-52.229c0-29.855-24.289-54.144-54.144-54.144
               c-29.855,0-54.144,24.289-54.144,54.144c0,24.925,16.936,45.958,39.9,52.229c-39.322,6.783-69.338,41.112-69.338,82.342v42.053
               c0,4.355,3.53,7.885,7.885,7.885h151.392c4.355,0,7.885-3.53,7.885-7.885v-42.053C366.916,391.395,336.9,357.066,297.578,350.283z
                M244.961,298.053c0-21.159,17.215-38.374,38.374-38.374s38.374,17.215,38.374,38.374c0,21.159-17.215,38.374-38.374,38.374
               S244.961,319.213,244.961,298.053z M351.146,466.793H215.524v-34.168c0-37.391,30.42-67.811,67.811-67.811
               s67.811,30.42,67.811,67.811V466.793z"/>
           </svg>

                <span id="loginButtonText">ورود - Login</span>
            </button>
        </div>

        <!-- بخش اصلی برنامه -->
        <div id="appContent" style="display: none;">
            <!-- بخش جستجو -->
            <div class="search-section">
                <h2 id="searchTitle">جستجو</h2>
                <input  type="text" id="searchInput" placeholder="جستجو - Search">
                <button onclick="searchExpenses()" id="searchButton">

                    <svg width="20pt" height="20pt" viewBox="-0.5 0 32 32" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                        <!-- Uploaded to: SVG Repo, www.svgrepo.com, Generator: SVG Repo Mixer Tools -->
                        <title>search</title>
                        <desc>Created with Sketch.</desc>
                        <defs>
                    </defs>
                        <g id="Vivid.JS" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                            <g id="Vivid-Icons" transform="translate(-748.000000, -489.000000)">
                                <g id="Icons" transform="translate(37.000000, 169.000000)">
                                    <g id="search" transform="translate(702.000000, 312.000000)">
                                        <g transform="translate(9.000000, 8.000000)" id="Shape">
                                            <polygon fill="#0C0058" points="17.283 20.611 27.889 31.218 30.717 28.39 20.111 17.783">
                    </polygon>
                                            <path d="M12,24 C5.372583,24 3.94430453e-31,18.627417 -1.77635684e-15,12 C-3.55271368e-15,5.372583 5.372583,3.94430453e-31 12,-1.77635684e-15 C18.627417,-3.55271368e-15 24,5.372583 24,12 C24,15.1825979 22.7357179,18.2348448 20.4852814,20.4852814 C18.2348448,22.7357179 15.1825979,24 12,24 Z M12,4 C7.581722,4 4,7.581722 4,12 C4,16.418278 7.581722,20 12,20 C16.418278,20 20,16.418278 20,12 C20,9.87826808 19.1571453,7.84343678 17.6568542,6.34314575 C16.1565632,4.84285472 14.1217319,4 12,4 Z" fill="#FF6E6E">
                    </path>
                                        </g>
                                    </g>
                                </g>
                            </g>
                        </g>
                    </svg>

                    <span id="searchButtonText">جستجو</span>
                </button>
                <button onclick="clearSearch()" id="clearSearchButton">


                    <svg width="20pt" height="20pt" viewBox="-0.5 0 32 32" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                        <!-- Uploaded to: SVG Repo, www.svgrepo.com, Generator: SVG Repo Mixer Tools -->
                        <title>search-disabled</title>
                        <desc>Created with Sketch.</desc>
                        <defs>
                    </defs>
                        <g id="Vivid.JS" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                            <g id="Vivid-Icons" transform="translate(-670.000000, -489.000000)">
                                <g id="Icons" transform="translate(37.000000, 169.000000)">
                                    <g id="search-disabled" transform="translate(624.000000, 312.000000)">
                                        <g transform="translate(9.000000, 8.000000)" id="Shape">
                                            <path d="M17.283,20.611 L27.889,31.218 L30.717,28.39 L20.111,17.783 L17.283,20.611 Z M14.829,16.243 L12,13.414 L9.172,16.242 L7.758,14.828 L10.586,12 L7.758,9.172 L9.172,7.758 L12,10.586 L14.828,7.758 L16.242,9.172 L13.414,12 L16.242,14.828 L14.829,16.243 Z" fill="#0C0058" fill-rule="nonzero">
                    </path>
                                            <path d="M12,24 C5.372583,24 3.94430453e-31,18.627417 -1.77635684e-15,12 C-3.55271368e-15,5.372583 5.372583,3.94430453e-31 12,-1.77635684e-15 C18.627417,-3.55271368e-15 24,5.372583 24,12 C24,15.1825979 22.7357179,18.2348448 20.4852814,20.4852814 C18.2348448,22.7357179 15.1825979,24 12,24 Z M12,4 C7.581722,4 4,7.581722 4,12 C4,16.418278 7.581722,20 12,20 C16.418278,20 20,16.418278 20,12 C20,9.87826808 19.1571453,7.84343678 17.6568542,6.34314575 C16.1565632,4.84285472 14.1217319,4 12,4 Z" fill="#FF6E6E" fill-rule="nonzero">
                    </path>
                                        </g>
                                    </g>
                                </g>
                            </g>
                        </g>
                    </svg>

                    <span id="clearSearchButtonText">رفع فیلتر</span>
                </button>
            </div>

            <!-- بخش ورود اطلاعات -->
            <div class="input-section">
                <h2 id="inputTitle">ورود اطلاعات</h2>
                <input type="text" id="titleInput" placeholder="هزینه - Cost">
                <input type="number" id="amountInput" placeholder="مبلغ - Amount">
                <input type="date" id="dateInput" placeholder="تاریخ - Date">
                <button onclick="addExpense()" id="addExpenseButton">


                    <svg height="20pt" width="20pt" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" 
                    viewBox="0 0 511.998 511.998" xml:space="preserve">
               <circle style="fill:#7DD2F0;" cx="256.002" cy="256.001" r="247.612"/>
               <path style="opacity:0.1;enable-background:new    ;" d="M64.319,255.998c0-127.294,96.063-232.134,219.645-246.028
                   c-9.181-1.032-18.508-1.582-27.965-1.582c-136.75,0-247.61,110.859-247.61,247.61s110.858,247.61,247.61,247.61
                   c9.457,0,18.783-0.549,27.965-1.582C160.382,488.134,64.319,383.293,64.319,255.998z"/>
               <polygon style="fill:#FFFFFF;" points="404.963,211.407 300.592,211.407 300.592,107.035 211.408,107.035 211.408,211.407 
                   107.037,211.407 107.037,300.591 211.408,300.591 211.408,404.963 300.592,404.963 300.592,300.591 404.963,300.591 "/>
               <path d="M255.999,511.998c-68.381,0-132.668-26.629-181.019-74.979C26.629,388.666,0,324.378,0,255.998
                   c0-36.75,7.624-72.228,22.662-105.45c14.525-32.09,35.169-60.412,61.359-84.178c3.432-3.114,8.738-2.857,11.85,0.575
                   c3.114,3.431,2.857,8.737-0.575,11.85c-49.898,45.282-78.518,109.868-78.518,177.202c0,63.899,24.883,123.972,70.067,169.155
                   c45.183,45.182,105.256,70.065,169.155,70.065c54.064,0,105.073-17.594,147.511-50.884c3.647-2.86,8.921-2.22,11.779,1.423
                   c2.86,3.645,2.221,8.92-1.423,11.779C368.445,493.165,313.855,511.998,255.999,511.998z"/>
               <path d="M116.4,59.876c-2.677,0-5.306-1.279-6.931-3.653c-2.604-3.807-1.648-8.997,2.133-11.626
                   c3.719-2.64,8.887-1.822,11.607,1.867c2.748,3.731,1.952,8.982-1.777,11.731c-0.078,0.058-0.22,0.159-0.302,0.213
                   C119.681,59.401,118.032,59.876,116.4,59.876z"/>
               <path d="M433.487,437.015c-2.109,0-4.218-0.79-5.849-2.376c-3.321-3.232-3.395-8.543-0.163-11.863
                   c43.687-44.908,67.745-104.138,67.745-166.777c0-63.898-24.883-123.971-70.067-169.154S319.897,16.779,255.998,16.779
                   c-48.378,0-94.988,14.377-134.79,41.575c-3.827,2.612-9.045,1.631-11.66-2.194c-2.614-3.826-1.632-9.046,2.194-11.66
                   C154.345,15.389,204.228,0,255.998,0c68.38,0,132.668,26.629,181.019,74.981s74.981,112.638,74.981,181.018
                   c0,67.034-25.748,130.418-72.498,178.476C437.857,436.166,435.673,437.015,433.487,437.015z"/>
               <path d="M300.592,413.351h-89.184c-4.634,0-8.389-3.755-8.389-8.389v-95.982h-95.982c-4.634,0-8.389-3.755-8.389-8.389v-89.184
                   c0-4.634,3.755-8.389,8.389-8.389h95.982v-95.981c0-4.634,3.755-8.389,8.389-8.389h89.184c4.634,0,8.389,3.755,8.389,8.389v95.982
                   h95.982c4.634,0,8.389,3.755,8.389,8.389v89.184c0,4.634-3.755,8.389-8.389,8.389h-95.982v95.982
                   C308.982,409.596,305.225,413.351,300.592,413.351z M219.797,396.572h72.406V300.59c0-4.634,3.755-8.389,8.389-8.389h95.982v-72.406
                   h-95.982c-4.634,0-8.389-3.755-8.389-8.389v-95.982h-72.406v95.982c0,4.634-3.755,8.389-8.389,8.389h-95.982v72.406h95.982
                   c4.634,0,8.389,3.755,8.389,8.389L219.797,396.572L219.797,396.572z"/>
               </svg>


                    <span id="addExpenseButtonText"> ذخیره </span>
                </button>
            </div>

            <!-- بخش صدور و دریافت اطلاعات -->
            <div class="export-section">
                <button onclick="exportToJSON()" id="exportButton">

                    <svg fill="#000000" width="20pt" height="20pt" viewBox="0 0 24 24" id="export" data-name="Flat Color" xmlns="http://www.w3.org/2000/svg" class="icon flat-color"><path id="secondary" d="M21,2H17a1,1,0,0,0,0,2h1.59l-8.3,8.29a1,1,0,0,0,0,1.42,1,1,0,0,0,1.42,0L20,5.41V7a1,1,0,0,0,2,0V3A1,1,0,0,0,21,2Z" style="fill: rgb(44, 169, 188);"></path><path id="primary" d="M18,22H4a2,2,0,0,1-2-2V6A2,2,0,0,1,4,4h6.11a1,1,0,0,1,0,2H4V20H18V13.89a1,1,0,0,1,2,0V20A2,2,0,0,1,18,22Z" style="fill: rgb(0, 0, 0);"></path></svg>

                    <span id="exportButtonText">صدور به JSON</span>
                </button>
                <button onclick="importFromJSON()" id="importButton">
<svg fill="#000000" width="20pt" height="20pt" viewBox="0 0 24 24" id="import-2" data-name="Flat Color" xmlns="http://www.w3.org/2000/svg" class="icon flat-color"><path id="secondary" d="M13,6a1,1,0,0,0-1,1v3.59L3.71,2.29A1,1,0,0,0,2.29,3.71L10.59,12H7a1,1,0,0,0,0,2h6a1,1,0,0,0,1-1V7A1,1,0,0,0,13,6Z" style="fill: rgb(44, 169, 188);"></path><path id="primary" d="M20,22H4a2,2,0,0,1-2-2V13a1,1,0,0,1,2,0v7H20V4H13a1,1,0,0,1,0-2h7a2,2,0,0,1,2,2V20A2,2,0,0,1,20,22Z" style="fill: rgb(0, 0, 0);"></path></svg>
                    <span id="importButtonText">دریافت از JSON</span>
                </button>
                <button onclick="exportToCSV()" id="exportCSVButton">
                    <svg fill="#000000" width="20pt" height="20pt" viewBox="0 0 24 24" id="export" data-name="Flat Color" xmlns="http://www.w3.org/2000/svg" class="icon flat-color"><path id="secondary" d="M21,2H17a1,1,0,0,0,0,2h1.59l-8.3,8.29a1,1,0,0,0,0,1.42,1,1,0,0,0,1.42,0L20,5.41V7a1,1,0,0,0,2,0V3A1,1,0,0,0,21,2Z" style="fill: rgb(44, 169, 188);"></path><path id="primary" d="M18,22H4a2,2,0,0,1-2-2V6A2,2,0,0,1,4,4h6.11a1,1,0,0,1,0,2H4V20H18V13.89a1,1,0,0,1,2,0V20A2,2,0,0,1,18,22Z" style="fill: rgb(0, 0, 0);"></path></svg>
                    <span id="exportCSVButtonText">صدور به CSV</span>
                </button>
                <button onclick="resetApp()" id="resetButton">

                    <svg width="20pt" height="20pt" viewBox="0 0 60 60" xmlns="http://www.w3.org/2000/svg"><defs><style>
                        .cls-1 {
                          fill: #9f4c4c;
                          fill-rule: evenodd;
                        }
                      </style></defs><path class="cls-1" d="M940,510a30,30,0,1,1,30-30A30,30,0,0,1,940,510Zm15-20.047A3.408,3.408,0,0,1,955,494.77l-0.221.22a3.42,3.42,0,0,1-4.833,0l-8.764-8.755a1.71,1.71,0,0,0-2.417,0l-8.741,8.747a3.419,3.419,0,0,1-4.836,0l-0.194-.193a3.408,3.408,0,0,1,.017-4.842l8.834-8.735a1.7,1.7,0,0,0,0-2.43l-8.831-8.725a3.409,3.409,0,0,1-.018-4.844l0.193-.193a3.413,3.413,0,0,1,2.418-1c0.944,0,3.255,1.835,3.872,2.455l7.286,7.287a1.708,1.708,0,0,0,2.417,0l8.764-8.748a3.419,3.419,0,0,1,4.832,0L955,465.243a3.408,3.408,0,0,1,0,4.818l-8.727,8.737a1.7,1.7,0,0,0,0,2.407Z" id="uncheck" transform="translate(-910 -450)"/></svg>

                    <span id="resetButtonText">ریست برنامه</span>
                </button>
            </div>

            <!-- بخش نمایش هزینه‌ها -->
            <div class="contacts-section">
                <h2 id="contactsTitle">لیست هزینه‌ها</h2>
                <!-- Combo Box برای انتخاب تعداد رکوردها -->
                <select id="pageSizeSelect" onchange="changePageSize()">
                    <option value="5">5</option>
                    <option value="10">10</option>
                    <option value="50">50</option>
                    <option value="0">All</option>
                </select>
                <span>رکورد در صفحه</span>
                <br><br>
                <table class="contacts-table">
                    <thead>
                        <tr>
                            <th id="titleHeader1">هزینه - Cost</th>
                            <th id="amountHeader1" onclick="sortExpenses('amount')">مبلغ -  Amount <span id="sortIcon">&#8595;</span></th>
                            <th id="dateHeader" onclick="sortExpenses('date')">تاریخ -  Date</th>
                            <th id="actionsHeader">اقدام - Action</th>
                        </tr>
                    </thead>
                    <tbody id="expensesTable">
                        <!-- هزینه‌ها اینجا نمایش داده می‌شوند -->
                    </tbody>
                    <tfoot>
                        <tr>
                            <td  id="totalAmount1" colspan="3" style="text-align: right;">جمع کل هزینه‌ها:</td>
                            <td id="totalAmount"></td>
                        </tr>
                    </tfoot>
                </table>
                <!-- نمایش شماره صفحه و تعداد صفحات -->
                	
                <div class="pagination">
                    <button onclick="prevPage()" id="prevPageButton">
                    	<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#fffacd" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M9 18l6-6-6-6"/>
                        </svg>
                    
                     
                        <span id="prevPageButtonText">قبلی</span>
                    </button>
                    &nbsp;&nbsp;
                    <div class="page-info" id="pageInfo"></div>
                    &nbsp;&nbsp;
                    <button onclick="nextPage()" id="nextPageButton">
                           <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#fffacd" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M15 18l-6-6 6-6"/>
                        </svg>
                        <span id="nextPageButtonText">بعدی</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // متغیرهای اصلی برنامه
        let expenses = [];
        let password = localStorage.getItem('expensesPassword');
        const appContent = document.getElementById('appContent');
        const loginSection = document.getElementById('loginSection');
        let currentPage = 1;
        let pageSize = 5;
        let language = 'fa';
        let sortOrder = 'asc'; // ترتیب مرتب‌سازی: صعودی (asc) یا نزولی (desc)

        // بررسی وجود رمز عبور
        if (!password) {
            // تنظیم رمز عبور برای اولین بار
            loginSection.innerHTML = `
                <h2 id="loginTitle">تنظیم رمز عبور</h2>
                <input type="password" id="passwordInput" placeholder="رمز جدید - New password">
                <button onclick="setPassword()" id="setPasswordButton">
<svg height="20pt" width="20pt" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" 
                viewBox="0 0 512 512" xml:space="preserve">
           <path style="fill:#687F82;" d="M282.524,7.887C205.947,8.327,144.559,71.61,144.559,148.188v36.322h42.053v-36.615
               c0-53.25,42.52-97.436,95.768-97.952c53.769-0.52,97.677,43.068,97.677,96.719v75.193c0,11.402,8.866,21.112,20.26,21.517
               c11.962,0.425,21.793-9.146,21.793-21.013v-75.696C422.111,69.87,359.417,7.446,282.524,7.887z"/>
           <path style="fill:#4ACFD9;" d="M464.164,504.115H102.505V253.897c0-17.419,14.12-31.54,31.54-31.54h298.579
               c17.419,0,31.54,14.122,31.54,31.54V504.115z"/>
           <g>
               <path style="fill:#FFD1A9;" d="M359.031,432.624c0-41.805-33.891-75.696-75.696-75.696s-75.696,33.891-75.696,75.696v42.053
                   h151.392V432.624z"/>
               <circle style="fill:#FFD1A9;" cx="283.335" cy="298.053" r="46.259"/>
           </g>
           <path style="fill:#0295AA;" d="M134.045,222.357c-17.42,0-31.54,14.12-31.54,31.54v250.218h180.83V222.357H134.045z"/>
           <g>
               <path style="fill:#FF8C29;" d="M207.639,432.624v42.053h75.696v-117.75C241.528,356.928,207.639,390.819,207.639,432.624z"/>
               <path style="fill:#FF8C29;" d="M237.076,298.053c0,25.548,20.71,46.259,46.259,46.259v-92.517
                   C257.786,251.795,237.076,272.505,237.076,298.053z"/>
           </g>
           <g>
               <path style="fill:#FFFFFF;" d="M422.111,390.045c-4.355,0-7.885-3.53-7.885-7.885V277.027c0-4.355,3.53-7.885,7.885-7.885
                   c4.355,0,7.885,3.53,7.885,7.885V382.16C429.996,386.515,426.466,390.045,422.111,390.045z"/>
               <path style="fill:#FFFFFF;" d="M422.111,461.536c-4.355,0-7.885-3.53-7.885-7.885v-42.053c0-4.355,3.53-7.885,7.885-7.885
                   c4.355,0,7.885,3.53,7.885,7.885v42.053C429.996,458.006,426.466,461.536,422.111,461.536z"/>
           </g>
           <g>
               <path style="fill:#F0353D;" d="M80.546,191.075h-32.71c-4.355,0-7.885-3.53-7.885-7.885s3.53-7.885,7.885-7.885h32.71
                   c4.355,0,7.885,3.53,7.885,7.885S84.901,191.075,80.546,191.075z"/>
               <path style="fill:#F0353D;" d="M89.678,164.312c-2.018,0-4.036-0.77-5.575-2.31l-20.815-20.815c-3.079-3.079-3.079-8.072,0-11.152
                   s8.072-3.079,11.15,0l20.815,20.815c3.079,3.079,3.079,8.072,0,11.152C93.714,163.542,91.695,164.312,89.678,164.312z"/>
               <path style="fill:#F0353D;" d="M68.651,238.653c-2.018,0-4.036-0.77-5.575-2.31c-3.079-3.079-3.079-8.072,0-11.15l20.815-20.815
                   c3.079-3.079,8.072-3.079,11.15,0c3.079,3.079,3.079,8.072,0,11.15l-20.815,20.815C72.687,237.883,70.669,238.653,68.651,238.653z"
                   />
           </g>
           <path d="M432.624,214.472h-2.628v-67.811c0-39.275-15.378-76.194-43.302-103.959C358.977,15.144,322.305,0,283.343,0
               c-0.287,0-0.576,0.001-0.864,0.002C202.081,0.464,136.674,66.94,136.674,148.188v36.322c0,4.355,3.53,7.885,7.885,7.885h42.053
               c4.355,0,7.885-3.53,7.885-7.885v-36.615c0-49.193,39.459-89.597,87.96-90.067c23.882-0.187,46.361,8.91,63.356,25.741
               c16.998,16.835,26.36,39.241,26.36,63.093v67.811H134.045c-21.74,0-39.425,17.686-39.425,39.425v250.218
               c0,4.355,3.53,7.885,7.885,7.885h361.659c4.355,0,7.885-3.53,7.885-7.885V253.897C472.049,232.158,454.364,214.472,432.624,214.472z
                M356.909,72.363c-20.009-19.816-46.504-30.609-74.605-30.305c-57.113,0.554-103.577,48.031-103.577,105.836v28.73h-26.283v-28.437
               c0-72.602,58.374-132.003,130.126-132.416c0.259-0.001,0.512-0.002,0.771-0.002c34.765,0,67.497,13.519,92.235,38.115
               c24.924,24.782,38.651,57.731,38.651,92.776v67.811h-26.283v-67.811C387.943,118.568,376.921,92.182,356.909,72.363z
                M456.279,496.23H110.39V253.897c0-13.044,10.611-23.655,23.655-23.655h246.037h42.029h10.513c13.044,0,23.655,10.611,23.655,23.655
               V496.23z"/>
           <path d="M297.578,350.283c22.964-6.271,39.9-27.304,39.9-52.229c0-29.855-24.289-54.144-54.144-54.144
               c-29.855,0-54.144,24.289-54.144,54.144c0,24.925,16.936,45.958,39.9,52.229c-39.322,6.783-69.338,41.112-69.338,82.342v42.053
               c0,4.355,3.53,7.885,7.885,7.885h151.392c4.355,0,7.885-3.53,7.885-7.885v-42.053C366.916,391.395,336.9,357.066,297.578,350.283z
                M244.961,298.053c0-21.159,17.215-38.374,38.374-38.374s38.374,17.215,38.374,38.374c0,21.159-17.215,38.374-38.374,38.374
               S244.961,319.213,244.961,298.053z M351.146,466.793H215.524v-34.168c0-37.391,30.42-67.811,67.811-67.811
               s67.811,30.42,67.811,67.811V466.793z"/>
           </svg>

                    <span id="setPasswordButtonText">تنظیم رمز</span>
                </button>
            `;
        } else {
            // نمایش بخش لاگین
            loginSection.innerHTML = `
                <h2 id="loginTitle">ورود به سیستم</h2>
                <input type="password" id="passwordInput" placeholder="رمز - Password">
                <button onclick="login()" id="loginButton">
<svg height="20pt" width="20pt" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" 
                viewBox="0 0 512 512" xml:space="preserve">
           <path style="fill:#687F82;" d="M282.524,7.887C205.947,8.327,144.559,71.61,144.559,148.188v36.322h42.053v-36.615
               c0-53.25,42.52-97.436,95.768-97.952c53.769-0.52,97.677,43.068,97.677,96.719v75.193c0,11.402,8.866,21.112,20.26,21.517
               c11.962,0.425,21.793-9.146,21.793-21.013v-75.696C422.111,69.87,359.417,7.446,282.524,7.887z"/>
           <path style="fill:#4ACFD9;" d="M464.164,504.115H102.505V253.897c0-17.419,14.12-31.54,31.54-31.54h298.579
               c17.419,0,31.54,14.122,31.54,31.54V504.115z"/>
           <g>
               <path style="fill:#FFD1A9;" d="M359.031,432.624c0-41.805-33.891-75.696-75.696-75.696s-75.696,33.891-75.696,75.696v42.053
                   h151.392V432.624z"/>
               <circle style="fill:#FFD1A9;" cx="283.335" cy="298.053" r="46.259"/>
           </g>
           <path style="fill:#0295AA;" d="M134.045,222.357c-17.42,0-31.54,14.12-31.54,31.54v250.218h180.83V222.357H134.045z"/>
           <g>
               <path style="fill:#FF8C29;" d="M207.639,432.624v42.053h75.696v-117.75C241.528,356.928,207.639,390.819,207.639,432.624z"/>
               <path style="fill:#FF8C29;" d="M237.076,298.053c0,25.548,20.71,46.259,46.259,46.259v-92.517
                   C257.786,251.795,237.076,272.505,237.076,298.053z"/>
           </g>
           <g>
               <path style="fill:#FFFFFF;" d="M422.111,390.045c-4.355,0-7.885-3.53-7.885-7.885V277.027c0-4.355,3.53-7.885,7.885-7.885
                   c4.355,0,7.885,3.53,7.885,7.885V382.16C429.996,386.515,426.466,390.045,422.111,390.045z"/>
               <path style="fill:#FFFFFF;" d="M422.111,461.536c-4.355,0-7.885-3.53-7.885-7.885v-42.053c0-4.355,3.53-7.885,7.885-7.885
                   c4.355,0,7.885,3.53,7.885,7.885v42.053C429.996,458.006,426.466,461.536,422.111,461.536z"/>
           </g>
           <g>
               <path style="fill:#F0353D;" d="M80.546,191.075h-32.71c-4.355,0-7.885-3.53-7.885-7.885s3.53-7.885,7.885-7.885h32.71
                   c4.355,0,7.885,3.53,7.885,7.885S84.901,191.075,80.546,191.075z"/>
               <path style="fill:#F0353D;" d="M89.678,164.312c-2.018,0-4.036-0.77-5.575-2.31l-20.815-20.815c-3.079-3.079-3.079-8.072,0-11.152
                   s8.072-3.079,11.15,0l20.815,20.815c3.079,3.079,3.079,8.072,0,11.152C93.714,163.542,91.695,164.312,89.678,164.312z"/>
               <path style="fill:#F0353D;" d="M68.651,238.653c-2.018,0-4.036-0.77-5.575-2.31c-3.079-3.079-3.079-8.072,0-11.15l20.815-20.815
                   c3.079-3.079,8.072-3.079,11.15,0c3.079,3.079,3.079,8.072,0,11.15l-20.815,20.815C72.687,237.883,70.669,238.653,68.651,238.653z"
                   />
           </g>
           <path d="M432.624,214.472h-2.628v-67.811c0-39.275-15.378-76.194-43.302-103.959C358.977,15.144,322.305,0,283.343,0
               c-0.287,0-0.576,0.001-0.864,0.002C202.081,0.464,136.674,66.94,136.674,148.188v36.322c0,4.355,3.53,7.885,7.885,7.885h42.053
               c4.355,0,7.885-3.53,7.885-7.885v-36.615c0-49.193,39.459-89.597,87.96-90.067c23.882-0.187,46.361,8.91,63.356,25.741
               c16.998,16.835,26.36,39.241,26.36,63.093v67.811H134.045c-21.74,0-39.425,17.686-39.425,39.425v250.218
               c0,4.355,3.53,7.885,7.885,7.885h361.659c4.355,0,7.885-3.53,7.885-7.885V253.897C472.049,232.158,454.364,214.472,432.624,214.472z
                M356.909,72.363c-20.009-19.816-46.504-30.609-74.605-30.305c-57.113,0.554-103.577,48.031-103.577,105.836v28.73h-26.283v-28.437
               c0-72.602,58.374-132.003,130.126-132.416c0.259-0.001,0.512-0.002,0.771-0.002c34.765,0,67.497,13.519,92.235,38.115
               c24.924,24.782,38.651,57.731,38.651,92.776v67.811h-26.283v-67.811C387.943,118.568,376.921,92.182,356.909,72.363z
                M456.279,496.23H110.39V253.897c0-13.044,10.611-23.655,23.655-23.655h246.037h42.029h10.513c13.044,0,23.655,10.611,23.655,23.655
               V496.23z"/>
           <path d="M297.578,350.283c22.964-6.271,39.9-27.304,39.9-52.229c0-29.855-24.289-54.144-54.144-54.144
               c-29.855,0-54.144,24.289-54.144,54.144c0,24.925,16.936,45.958,39.9,52.229c-39.322,6.783-69.338,41.112-69.338,82.342v42.053
               c0,4.355,3.53,7.885,7.885,7.885h151.392c4.355,0,7.885-3.53,7.885-7.885v-42.053C366.916,391.395,336.9,357.066,297.578,350.283z
                M244.961,298.053c0-21.159,17.215-38.374,38.374-38.374s38.374,17.215,38.374,38.374c0,21.159-17.215,38.374-38.374,38.374
               S244.961,319.213,244.961,298.053z M351.146,466.793H215.524v-34.168c0-37.391,30.42-67.811,67.811-67.811
               s67.811,30.42,67.811,67.811V466.793z"/>
           </svg>

                    <span id="loginButtonText">ورود - Login</span>
                </button>
            `;
        }

        // تابع برای تغییر زبان
        function changeLanguage(lang) {
            language = lang;
            updateUI();
        }

        // تابع برای به‌روزرسانی رابط کاربری بر اساس زبان
        function updateUI() {
            const translations = {
                fa: {
                    title: 'خریدهای ماه',
                    loginTitle: 'ورود به سیستم',
                    searchTitle: 'جستجو',
                    inputTitle: 'ورود اطلاعات',
                    contactsTitle: 'لیست هزینه‌ها',
                    totalAmount: 'جمع کل هزینه‌ها:',
                    prevPage: 'قبلی',
                    nextPage: 'بعدی',
                    exportJSON: 'صدور به JSON',
                    importJSON: 'دریافت از JSON',
                    exportCSV: 'صدور به CSV',
                    reset: 'ریست برنامه',
                    addExpense: 'ثبت',
                    search: 'جستجو',
                    clearSearch: 'رفع فیلتر',
                    setPassword: 'تنظیم رمز',
                    login: 'ورود',
                    sortIcon: '&#8595;',
                    columnTitle: 'عنوان هزینه',
                    columnAmount: 'مبلغ',
                    columnDate: 'تاریخ هزینه',
                    searchPlaceholder: 'جستجو...',
                    titlePlaceholder: 'عنوان هزینه',
                    amountPlaceholder: 'مبلغ',
                    datePlaceholder: 'تاریخ هزینه'
                },
                en: {
                    title: 'Monthly Expenses',
                    loginTitle: 'Login',
                    searchTitle: 'Search',
                    inputTitle: 'Enter Information',
                    contactsTitle: 'Expenses List',
                    totalAmount: 'Total Expenses:',
                    prevPage: 'Previous',
                    nextPage: 'Next',
                    exportJSON: 'Export to JSON',
                    importJSON: 'Import from JSON',
                    exportCSV: 'Export to CSV',
                    reset: 'Reset App',
                    addExpense: 'Add',
                    search: 'Search',
                    clearSearch: 'Clear Filter',
                    setPassword: 'Set Password',
                    login: 'Login',
                    sortIcon: '&#8595;',
                    columnTitle: 'Expense Title',
                    columnAmount: 'Amount',
                    columnDate: 'Expense Date',
                    searchPlaceholder: 'Search...',
                    titlePlaceholder: 'Expense Title',
                    amountPlaceholder: 'Amount',
                    datePlaceholder: 'Expense Date'
                },
                zh: {
                    title: '月度支出',
                    loginTitle: '登录',
                    searchTitle: '搜索',
                    inputTitle: '输入信息',
                    contactsTitle: '支出列表',
                    totalAmount: '总支出:',
                    prevPage: '上一页',
                    nextPage: '下一页',
                    exportJSON: '导出到 JSON',
                    importJSON: '从 JSON 导入',
                    exportCSV: '导出到 CSV',
                    reset: '重置应用',
                    addExpense: '添加',
                    search: '搜索',
                    clearSearch: '清除筛选',
                    setPassword: '设置密码',
                    login: '登录',
                    sortIcon: '&#8595;',
                    columnTitle: '支出标题',
                    columnAmount: '金额',
                    columnDate: '支出日期',
                    searchPlaceholder: '搜索...',
                    titlePlaceholder: '支出标题',
                    amountPlaceholder: '金额',
                    datePlaceholder: '支出日期'
                }
            };

            const translation = translations[language];
            document.getElementById('titleText').textContent = translation.title;
            document.getElementById('loginTitle').textContent = translation.loginTitle;
            document.getElementById('searchTitle').textContent = translation.searchTitle;
            document.getElementById('inputTitle').textContent = translation.inputTitle;
            document.getElementById('contactsTitle').textContent = translation.contactsTitle;
            document.getElementById('totalAmount1').textContent = translation.totalAmount;
            document.getElementById('prevPageButtonText').textContent = translation.prevPage;
            document.getElementById('nextPageButtonText').textContent = translation.nextPage;
            document.getElementById('exportButtonText').textContent = translation.exportJSON;
            document.getElementById('importButtonText').textContent = translation.importJSON;
            document.getElementById('exportCSVButtonText').textContent = translation.exportCSV;
            document.getElementById('resetButtonText').textContent = translation.reset;
            document.getElementById('addExpenseButtonText').textContent = translation.addExpense;
            document.getElementById('searchButtonText').textContent = translation.search;
            document.getElementById('clearSearchButtonText').textContent = translation.clearSearch;
            document.getElementById('setPasswordButtonText').textContent = translation.setPassword;
            document.getElementById('loginButtonText').textContent = translation.login;
            document.getElementById('sortIcon').innerHTML = translation.sortIcon;
         document.getElementById('titleHeader1').innerHTML = translation.columnTitle;   
            
document.getElementById('titleHeader1').textContent = translation.columnTitle;
            document.getElementById('amountHeader1').innerHTML = `${translation.columnAmount} <span id="sortIcon">${translation.sortIcon}</span>`;
            document.getElementById('dateHeader').textContent = translation.columnDate;

            // به‌روزرسانی placeholderها
            document.getElementById('searchInput').placeholder = translation.searchPlaceholder;
            document.getElementById('titleInput').placeholder = translation.titlePlaceholder;
            document.getElementById('amountInput').placeholder = translation.amountPlaceholder;
            document.getElementById('dateInput').placeholder = translation.datePlaceholder;
        }

        // تابع برای هش کردن رمز عبور با SHA-256
        async function sha256(message) {
            const msgBuffer = new TextEncoder().encode(message);
            const hashBuffer = await crypto.subtle.digest('SHA-256', msgBuffer);
            const hashArray = Array.from(new Uint8Array(hashBuffer));
            const hashHex = hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
            return hashHex;
        }

        // تنظیم رمز عبور
        async function setPassword() {
            const newPassword = document.getElementById('passwordInput').value;
            if (newPassword) {
                // هش کردن رمز عبور با SHA-256
                const hashedPassword = await sha256(newPassword);
                localStorage.setItem('expensesPassword', hashedPassword);
                password = hashedPassword;
                loginSection.style.display = 'none';
                appContent.style.display = 'block';
                loadExpenses();
            }
        }

        // ورود به سیستم
        async function login() {
            const enteredPassword = document.getElementById('passwordInput').value;
            if (enteredPassword === 'reset') {
                if (confirm(language === 'fa' ? 'آیا مطمئن هستید؟ این عمل تمام اطلاعات و رمز عبور را پاک می‌کند.' : 'Are you sure? This will delete all data and reset the password.')) {
                    localStorage.removeItem('expenses');
                    localStorage.removeItem('expensesPassword');
                    window.location.reload();
                }
                return;
            }
            const hashedPassword = await sha256(enteredPassword);
            if (hashedPassword === password) {
                loginSection.style.display = 'none';
                appContent.style.display = 'block';
                loadExpenses();
            } else {
                alert(language === 'fa' ? 'رمز عبور اشتباه است! برای ریست کردن، کلمه‌ی "reset" را وارد کنید.' : 'Incorrect password! Enter "reset" to reset the app.');
            }
        }

        // بارگذاری هزینه‌ها از Local Storage
        function loadExpenses() {
            const storedExpenses = localStorage.getItem('expenses');
            if (storedExpenses) {
                expenses = JSON.parse(storedExpenses);
                renderExpenses();
            }
        }

        // نمایش هزینه‌ها در جدول
        function renderExpenses(filteredExpenses = expenses) {
            const tableBody = document.getElementById('expensesTable');
            tableBody.innerHTML = '';
            const start = (currentPage - 1) * pageSize;
            const end = pageSize === 0 ? filteredExpenses.length : start + pageSize;
            const paginatedExpenses = filteredExpenses.slice(start, end);
            paginatedExpenses.forEach((expense, index) => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${expense.title}</td>
                    <td>${expense.amount}</td>
                    <td>${expense.date}</td>
                    <td>
                        <button onclick="editExpense(${index})">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#fffacd" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"/>
                            </svg>
                        </button>
                        <button onclick="deleteExpense(${index})">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#fffacd" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M3 6h18M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/>
                            </svg>
                        </button>
                    </td>
                `;
                tableBody.appendChild(row);
            });
            // محاسبه و نمایش جمع کل هزینه‌ها
            const totalAmount = filteredExpenses.reduce((sum, expense) => sum + parseFloat(expense.amount), 0);
            document.getElementById('totalAmount').textContent = totalAmount.toFixed(2);
            // نمایش اطلاعات صفحه
            const totalPages = Math.ceil(filteredExpenses.length / pageSize);
            document.getElementById('pageInfo').textContent = `صفحه ${currentPage} از ${totalPages}`;
        }

        // افزودن هزینه جدید
        function addExpense() {
            const title = document.getElementById('titleInput').value;
            const amount = document.getElementById('amountInput').value;
            const date = document.getElementById('dateInput').value;
            if (title && amount && date) {
                expenses.push({ title, amount, date });
                localStorage.setItem('expenses', JSON.stringify(expenses));
                renderExpenses();
                document.getElementById('titleInput').value = '';
                document.getElementById('amountInput').value = '';
                document.getElementById('dateInput').value = '';
            }
        }

        // ویرایش هزینه
        function editExpense(index) {
            const newTitle = prompt(language === 'fa' ? 'عنوان جدید را وارد کنید:' : 'Enter new title:', expenses[index].title);
            const newAmount = prompt(language === 'fa' ? 'مبلغ جدید را وارد کنید:' : 'Enter new amount:', expenses[index].amount);
            const newDate = prompt(language === 'fa' ? 'تاریخ جدید را وارد کنید:' : 'Enter new date:', expenses[index].date);
            if (newTitle && newAmount && newDate) {
                expenses[index] = { title: newTitle, amount: newAmount, date: newDate };
                localStorage.setItem('expenses', JSON.stringify(expenses));
                renderExpenses();
            }
        }

        // حذف هزینه
        function deleteExpense(index) {
            if (confirm(language === 'fa' ? 'آیا مطمئن هستید؟' : 'Are you sure?')) {
                expenses.splice(index, 1);
                localStorage.setItem('expenses', JSON.stringify(expenses));
                renderExpenses();
            }
        }

        // جستجوی هزینه‌ها
        function searchExpenses() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const filteredExpenses = expenses.filter(expense => 
                expense.title.toLowerCase().includes(searchTerm) || 
                expense.amount.includes(searchTerm) ||
                expense.date.includes(searchTerm)
            );
            renderExpenses(filteredExpenses);
        }

        // پاک کردن جستجو
        function clearSearch() {
            document.getElementById('searchInput').value = '';
            renderExpenses();
        }

        // صدور اطلاعات به صورت JSON
        function exportToJSON() {
            const dataStr = JSON.stringify(expenses);
            const dataUri = 'data:application/json;charset=utf-8,' + encodeURIComponent(dataStr);
            const exportFileDefaultName = 'expenses.json';
            const linkElement = document.createElement('a');
            linkElement.setAttribute('href', dataUri);
            linkElement.setAttribute('download', exportFileDefaultName);
            linkElement.click();
        }

        // دریافت اطلاعات از فایل JSON
        function importFromJSON() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            input.onchange = e => {
                const file = e.target.files[0];
                const reader = new FileReader();
                reader.onload = e => {
                    const text = e.target.result;
                    expenses = JSON.parse(text);
                    localStorage.setItem('expenses', JSON.stringify(expenses));
                    renderExpenses();
                };
                reader.readAsText(file);
            };
            input.click();
        }

        // صدور اطلاعات به صورت CSV
        function exportToCSV() {
            const headers = ['عنوان هزینه', 'مبلغ', 'تاریخ هزینه'];
            const rows = expenses.map(expense => [expense.title, expense.amount, expense.date]);
            const csvContent = [headers.join(','), ...rows.map(row => row.join(','))].join('\n');
            const dataUri = 'data:text/csv;charset=utf-8,' + encodeURIComponent(csvContent);
            const exportFileDefaultName = 'expenses.csv';
            const linkElement = document.createElement('a');
            linkElement.setAttribute('href', dataUri);
            linkElement.setAttribute('download', exportFileDefaultName);
            linkElement.click();
        }

        // ریست برنامه
        function resetApp() {
            if (confirm(language === 'fa' ? 'آیا مطمئن هستید؟ این عمل تمام اطلاعات و رمز عبور را پاک می‌کند.' : 'Are you sure? This will delete all data and reset the password.')) {
                localStorage.removeItem('expenses');
                localStorage.removeItem('expensesPassword');
                window.location.reload();
            }
        }

        // تغییر تعداد رکوردهای نمایش داده شده
        function changePageSize() {
            pageSize = parseInt(document.getElementById('pageSizeSelect').value);
            currentPage = 1;
            renderExpenses();
        }

        // رفتن به صفحه قبلی
        function prevPage() {
            if (currentPage > 1) {
                currentPage--;
                renderExpenses();
            }
        }

        // رفتن به صفحه بعدی
        function nextPage() {
            const totalPages = Math.ceil(expenses.length / pageSize);
            if (currentPage < totalPages) {
                currentPage++;
                renderExpenses();
            }
        }

        // مرتب‌سازی هزینه‌ها بر اساس مبلغ
        function sortExpenses(column) {
            if (column === 'amount') {
                if (sortOrder === 'asc') {
                    expenses.sort((a, b) => parseFloat(a.amount) - parseFloat(b.amount));
                    sortOrder = 'desc';
                } else {
                    expenses.sort((a, b) => parseFloat(b.amount) - parseFloat(a.amount));
                    sortOrder = 'asc';
                }
                renderExpenses();
            }
        }
    </script>
</body>
</html>